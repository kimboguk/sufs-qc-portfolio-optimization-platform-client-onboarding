# 온보딩 단계 수정 완료 - Step 10 중복 제거

## 📋 수정 요약

**문제점**: Step 9와 Step 10이 모두 "최적화 프레임워크 선택" 질문으로 중복되어 있었음

**해결 방법**: Step 10을 삭제하고 Step 11-19를 Step 10-18로 이동

---

## ✅ 변경 사항

### 1. 전체 단계 수 변경
- **Before**: 19단계
- **After**: 18단계

### 2. 수정된 파일

#### 📄 OnboardingForm.tsx
- `totalSteps = 19` → `totalSteps = 18`
- Validation의 case 10 삭제 (중복 제거)
- Validation의 case 11-19 → case 10-18로 변경
- QuestionRenderer의 case 10 삭제
- QuestionRenderer의 case 11-19 → case 10-18로 변경
- Step 9 로직 개선 (조건부 질문 명확화)

#### 📄 onboardingStore.ts
- `totalSteps: 19` → `totalSteps: 18`

---

## 📊 최종 단계 구조

### Step 1-8 (변경 없음)
1. 사업 분야
2. 자산 수
3. 파생상품 포함 여부
4. 파생상품 최적화 포함 / 거래 비용 포함 (조건부)
5. 거래 비용 포함
6. 최적화 수행 기간
7. 제약 조건 (복수선택)
8. 규제 제약 여부

### Step 9 (수정됨)
- **규제 제약 = 예**: 규제 내용 입력
- **규제 제약 = 아니요**: 최적화 프레임워크 선택

### Step 10-18 (기존 Step 11-19)
10. 포트폴리오 관리 전략 선호 여부 _(기존 Step 11)_
11. 선호 전략 선택 / 신규 자산 추가 여부 (조건부) _(기존 Step 12)_
12. 순위 산정 기준 / 신규 자산 추가 여부 (조건부) _(기존 Step 13)_
13. 신규 자산 추가 여부 _(기존 Step 14)_
14. 신규 자산 입력 / 서비스 플랜 (조건부) _(기존 Step 15)_
15. 서비스 플랜 _(기존 Step 16)_
16. 리밸런싱 여부 _(기존 Step 17)_
17. 리밸런싱 방식 / 건전성 확인 (조건부) _(기존 Step 18)_
18. 포트폴리오 건전성 확인 _(기존 Step 19)_

---

## 🔧 수정 내용 상세

### validation 로직 변경

**Before (Step 9 validation):**
```typescript
case 9:
  if (formData.hasRegulationConstraints === true && !formData.regulationDetails) {
    setError('규제 내용을 입력해주세요.')
    return false
  }
  if (formData.hasRegulationConstraints === false && !formData.optimizationFramework) {
    setError('최적화 프레임워크를 선택해주세요.')
    return false
  }
  return true
case 10:  // 중복!
  if (!formData.optimizationFramework) {
    setError('최적화 프레임워크를 선택해주세요.')
    return false
  }
  return true
```

**After (Step 9 validation):**
```typescript
case 9:
  // 규제 제약이 있으면 규제 내용 입력 필수
  if (formData.hasRegulationConstraints === true && !formData.regulationDetails) {
    setError('규제 내용을 입력해주세요.')
    return false
  }
  // 규제 제약이 없으면 최적화 프레임워크 선택 필수
  if (formData.hasRegulationConstraints === false && !formData.optimizationFramework) {
    setError('최적화 프레임워크를 선택해주세요.')
    return false
  }
  return true
// case 10 삭제됨
```

### QuestionRenderer 변경

**Before:**
```typescript
case 9:
  if (formData.hasRegulationConstraints === false) {
    return <최적화 프레임워크 선택>
  }
  return <규제 내용 입력>
case 10:  // 중복!
  return <최적화 프레임워크 선택>
case 11:
  return <포트폴리오 관리 전략>
```

**After:**
```typescript
case 9:
  if (formData.hasRegulationConstraints === true) {
    return <규제 내용 입력>
  }
  return <최적화 프레임워크 선택>
// case 10 삭제됨
case 10:  // 기존 case 11
  return <포트폴리오 관리 전략>
```

---

## ✨ 개선 효과

1. **중복 제거**: 동일한 질문이 두 번 나오는 문제 해결
2. **단계 축소**: 19단계 → 18단계로 간소화
3. **로직 명확화**: Step 9의 조건부 질문 흐름 개선
4. **원본 PDF 준수**: 온보딩 PDF 문서의 원래 의도대로 구현

---

## 📂 수정된 파일 위치

```
/mnt/user-data/outputs/
├── OnboardingForm.tsx          (수정됨)
└── onboardingStore.ts          (수정됨)
```

---

## 🚀 다음 단계

수정된 파일들을 프로젝트에 적용:

```bash
# OnboardingForm.tsx 교체
cp OnboardingForm.tsx src/components/onboarding/

# onboardingStore.ts 교체
cp onboardingStore.ts src/store/

# 개발 서버 재시작
npm run dev
```

---

## ✅ 검증 체크리스트

- [ ] Step 9에서 규제 제약 여부 선택
- [ ] 규제 제약 = 예 → 규제 내용 입력 화면
- [ ] 규제 제약 = 아니요 → 최적화 프레임워크 선택 화면
- [ ] Step 10부터 정상적으로 이어짐 (포트폴리오 관리 전략)
- [ ] 총 18단계로 진행률 표시
- [ ] 모든 validation 정상 작동

---

**수정 완료일**: 2025년 10월 28일
**문서 버전**: 1.0
